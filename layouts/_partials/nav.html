{{- /*
Renders a menu for the given menu ID.

@context {page} page The current page.
@context {string} menuID The menu ID.

@example: {{ partial "menu.html" (dict "menuID" "main" "page" .) }}
*/}}

{{- $page := .page }}
{{- $menuID := .menuID }}
	<nav class="navbar navbar-expand-lg bg-body-secondary sticky-top">
		<div class="container-fluid">
			<a class="navbar-brand" href="{{ site.BaseURL}}">{{ site.Title }}</a>
			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#main-navbar"
				aria-controls="main-navbar" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="main-navbar">
{{- with index site.Menus $menuID }}
				<ul class="navbar-nav ms-md-auto">
{{- partial "inline/menu/walk.html" (dict "page" $page "menuEntries" .) }}
				</ul>
{{- end }}
			</div>
			<div class="avatar-container">
				<div class="avatar-img-border">
					<a title="{{ site.Title }}" href="{{ site.BaseURL }}">
						<img class="avatar-img" src="{{ site.Params.logo }}" alt="">
					</a>
				</div>
			</div>
		</div>
	</nav>

{{- define "_partials/inline/menu/walk.html" }}
{{- $page := .page }}
{{- range .menuEntries }}
	{{- $attrs := dict "href" .URL }}
	{{- if $page.IsMenuCurrent .Menu . }}
		{{- $attrs = merge $attrs (dict "class" "active" "aria-current" "page") }}
	{{- else if $page.HasMenuCurrent .Menu .}}
		{{- $attrs = merge $attrs (dict "class" "ancestor" "aria-current" "true") }}
	{{- end }}

	{{- $name := .Name }}
	{{- with .Identifier }}
		{{- with T . }}
			{{- $name = . }}
		{{- end }}
	{{- end }}

	{{- with .Children }}
					<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">{{ $name }}</a>
					<ul class="dropdown-menu dropdown-menu-end bg-body-secondary">
	{{- partial "inline/menu/walk.html" (dict "page" $page "menuEntries" .) }}
					</ul>
					</li>
					{{- else }}
					<li class="nav-item"><a class="nav-link" aria-current="page"
					{{- range $k, $v := $attrs }}
						{{- with $v }}
							{{- printf " %s=%q" $k $v | safeHTMLAttr }}
						{{- end }}
					{{- end -}}
					>{{ $name }}</a></li>
	{{- end }}
{{- end }}
{{- end -}}
